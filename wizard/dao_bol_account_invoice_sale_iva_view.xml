<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<!-- XML para tener el Menu, el form y la accion para mostrar y ejecutar el WIZARD para generar el reporte de libro de ventas IVA.  
    
    Es muy importante q en el XML primero coloquemos el VIEW, desde el Action y por ultimo el MenuItem, sino da error como si no existieran estos.
    -->

    <!-- Adicionamos el VIEW para el WIZARD -->
    <record id="dao_account_invoice_sale_iva_report_wizard_view" model="ir.ui.view">
        <field name="name">Sales IVA</field>
        <field name="model">dao.account.invoice.sale.iva.report.wizard</field>
        <field name="arch" type="xml">
            <form string="Report Options">
                <group col="4">
                    <field name="date_start"/>
                    <field name="date_end"/>
                    <field name="enable_csv" />
                </group>
                <notebook tabpos="up" colspan="4">
                    <page string="CSV" name="csv" attrs="{'invisible': [('enable_csv','=',False)]}">
                        <group>
                            <field name="csv_with_column_names"/>
                            <field name="csv_with_thousand_separator" />
                            <field name="csv_delimiter" attrs="{'required': [('enable_csv', '=', True)]}"/>
                            <field name="csv_quotechar" attrs="{'required': [('enable_csv', '=', True)]}"/>
                        </group>
                    </page>
                </notebook>
                <footer>
                    <button name="generate_report" string="Print" type="object" default_focus="1" class="oe_highlight"/>
                    or 
                    <button string="Cancel" class="oe_link" special="cancel" />
                </footer>
            </form>
        </field>
    </record>

    <!-- Adicionamos la Accion para el menu dao_menu_sales_iva -->
    <record id="action_dao_account_invoice_sale_iva_menu" model="ir.actions.act_window">
        <field name="name">Sales IVA</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">dao.account.invoice.sale.iva.report.wizard</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="dao_account_invoice_sale_iva_report_wizard_view"/>
        <field name="target">new</field>
    </record>
    
    <!-- Adicionamos un item al menu del grupo PDF REPORTS de modulo accounting -->
    <menuitem
        id="dao_menu_sales_iva"
        name="Sales IVA"
        parent="account.menu_finance_legal_statement"
        action="action_dao_account_invoice_sale_iva_menu"
        groups="account.group_account_manager,account.group_account_user"
       />

    <!-- Adicionamos el View WIZARD para descargar el CSV Libro de Ventas IVA 
    Este WIZARD se lo llama cuando el usuario indica que el reporte lo quiere como CSV.
    Es muy importante que el name se llame igual que el id, xq asi lo buscamos en la logica de 
    wizard-> dao_bol_account_invoice_sale_iva.py -> def _generate_csv
    el model es el mismo que el WIZARD de filtros 'dao.account.invoice.sale.iva.report.wizard'
    -->
    <record id="dao_account_invoice_sale_iva_report_wizard_csv_done" model="ir.ui.view">
            <field name="name">dao_account_invoice_sale_iva_report_wizard_csv_done</field>
            <field name="model">dao.account.invoice.sale.iva.report.wizard</field>
            <field name="arch" type="xml">
                <form string="SALES IVA CSV" version="7.0">
                <!-- <form string="SALES IVA CSV">     -->
                    <group cols="2">
                        <field name="csv_name" invisible="1" />
                        <label string="The CSV file has been successfully generated." />
                        <field name="csv_data" filename="csv_name" nolabel="1" />
                    </group>
                    <footer>
                        <button special="cancel" string="Close" type="object" />
                    </footer>
                </form>
            </field>
        </record>

</odoo>